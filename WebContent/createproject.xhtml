<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      >
    <h:body>
 
    	<ui:composition template="/templates/masterLayout.xhtml">
 			
 			
 			
    		<ui:define name="content">
					
					<h1 class="header">#{msg['page.createProject.title']}</h1>
					<h2 class="header">#{msg['page.createProject.subtitle']}</h2>
					<p class="description">#{msg['page.createProject.description']}</p>
					<h:form id="form" class="basicForm">
						<blockquote style="clear:both;">
							<h:outputLabel for="">#{msg['form.projectName']}</h:outputLabel>
							<h:inputText id="projectName" required="true" styleClass="#{component.valid ? '' : 'error'}">
				        		<f:ajax event="blur" render="projectNameRequiredMessage projectName"/>
					        </h:inputText>
					        <h:message id="projectNameRequiredMessage" for="projectName" class="error" />
							
						</blockquote>
						<blockquote style="clear:both;">
							<h:outputLabel for="">#{msg['form.creditAmount']}</h:outputLabel>
							<h:inputText id="creditAmount" required="true" styleClass="#{component.valid ? '' : 'error'}">
				        		<f:ajax event="blur" render="creditAmountRequiredMessage creditAmount"/>
					        </h:inputText>
					        <h:message id="creditAmountRequiredMessage" for="creditAmount" class="error" />
						</blockquote>
						<blockquote style="clear:both;">
							<h:outputLabel for="">#{msg['form.projectDuration']}</h:outputLabel>
							<h:inputText id="duration" required="true" styleClass="#{component.valid ? '' : 'error'}">
				        		<f:ajax event="blur" render="durationRequiredMessage duration" />
					        </h:inputText>
					        <h:message id="durationRequiredMessage" for="duration" class="error" />
						</blockquote>
						<blockquote style="clear:both;">
							<h:outputLabel for="">#{msg['form.income']}</h:outputLabel>
							<h:inputText id="income" required="true" styleClass="#{component.valid ? '' : 'error'}">
				        		<f:ajax event="blur" render="incomeRequiredMessage income"/>
					        </h:inputText>
					        <h:message id="incomeRequiredMessage" for="income" class="error" />
						</blockquote>
						<blockquote style="clear:both;">
							<h:outputLabel for="">#{msg['form.expenses']}</h:outputLabel>
							<h:inputText id="expenses" required="true" styleClass="#{component.valid ? '' : 'error'}">
				        		<f:ajax event="blur" render="expensesRequiredMessage expenses"/>
					        </h:inputText>
					        <h:message id="expensesRequiredMessage" for="expenses" class="error" />
						</blockquote>
						<blockquote style="clear:both;">
							<script>
				 				$(function(){
				 					//alertHandler.display("success", "test alert.", 500);
				 					function testCallback(data) {
				 					//	alertHandler.display("success", "test alert.", 500);
				 					}
				 					//jsf.ajax.addOnEvent(testCallback);
				 					function handleAjaxResponse(xhr, status, args) {
				 						alertHandler.display("success", "test", 0);
				 					}
				 					/*
				 					jsf.ajax.addOnEvent(function(data) {
				 				        var ajaxstatus = data.status; // Can be "begin", "complete" and "success"
										var testOutput = "data content: ";
				 				        
				 				        for(var x in data)
				 				        	{
				 				        		testOutput += x;
				 				        		testOutput += " ";
				 				        	}
				 				        switch (ajaxstatus) {
				 				            case "begin": // This is called right before ajax request is been sent.
				 				                //bla
				 				                break;

				 				            case "complete": // This is called right after ajax response is received.
				 				                //bla
				 				                break;

				 				            case "success": // This is called when ajax response is successfully processed.
				 				            	alertHandler.display("success", data.source.type + " " + document.getElementById("form:formSubmit"), 0);
				 				                break;
				 				        }
				 				    });
				 					/*
				 					jsf.ajax.addOnEvent(function(data) {
				 				        var ajaxstatus = data.status; // Can be "begin", "complete" and "success"
				 				        var ajaxloader = document.getElementById("ajaxloader");

				 				        switch (ajaxstatus) {
				 				            case "begin": // This is called right before ajax request is been sent.
				 				                //bla
				 				                break;

				 				            case "complete": // This is called right after ajax response is received.
				 				                //bla
				 				                break;

				 				            case "success": // This is called when ajax response is successfully processed.
				 				                //bla
				 				                break;
				 				        }
				 				    });/**/
				 				});
				 			</script>
				 			
				 			
				 			<h3> Status:</h3>
<textarea id="statusArea" cols="40" rows="10" readonly="readonly" />
<!-- 
//IDEA: make an <outputScript> for the alert and set a condition in the bean, rerender the script on submit of the form 
//if the form is validated successfully submit the data to the backing bean and the alert will be displaied. the message 
//is set in the script under an additional condition
-->

<h:outputScript id="alertScript" rendered="#{form.valid}">
	$(function(){
		alertHandler.display("success", "test", 0);
	});
</h:outputScript>

<script>
var statusUpdate = function statusUpdate(data) {
    var statusArea = document.getElementById("statusArea");
    var text = statusArea.value;
    text = text + "Name: "+data.source.id;
    if (data.type === "event") {
        text = text +" Event: "+data.name+"\n";
    } else {  // otherwise, it's an error
        text = text + " Error: "+data.name+"\n";
    }
    statusArea.value = text;
};

// Setup the statusUpdate function to hear all events on the page
jsf.ajax.addOnEvent(statusUpdate);
jsf.ajax.addOnError(statusUpdate);</script>

							<a4j:commandButton value="" execute="@none" oncomplete="#{}" />
				 			<!-- 
				 			<h:commandButton id="formSubmit" type="submit"
							ajax="true" 
							value="#{msg['form.createProjectSubmit']}">
								<f:ajax execute="@form" render="@form content"  />
							</h:commandButton> -->
						</blockquote>
					</h:form>	
    		</ui:define>
 
    	</ui:composition>
 
    </h:body>
 
</html>